<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Studie Dashboard</title>
    <!-- Link naar de externe CSS-stijl -->
    <link rel="stylesheet" href="style.css">
    <!-- Link naar jQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <!-- Link naar Google Charts API -->
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
        // Laad de Google Charts packages
        google.charts.load('current', {'packages':['corechart', 'line']});
        // Stel de callback in om de grafieken te tekenen wanneer de libraries geladen zijn
        google.charts.setOnLoadCallback(drawCharts);

        function drawCharts() {
            // AJAX-aanroep voor formatieve toetsen
            $.ajax({
                url: 'formatief.php', // URL van de PHP-script die de data levert
                dataType: 'json', // Verwachte datatypes
                success: function(data) { // Bij succesvolle aanroep
                    console.log("Formatieve toetsen data:", data); // Log de ontvangen data

                    // Maak de data voor de piechart
                    var formatieveData = google.visualization.arrayToDataTable([
                        ['Task', 'Aantal'], 
                        ['Behaald', parseFloat(data.behaald)], // Zorg ervoor dat dit een nummer is
                        ['Nog te doen', parseFloat(data.nog_te_doen)] // Zorg ervoor dat dit een nummer is
                    ]);

                    // Stijl en opties voor de grafiek
                    var options1 = {
                        title: 'Formatieve Toetsen',
                        pieHole: 0.4, // Maak een donut-grafiek
                        slices: {
                            0: { offset: 0.1, color: '#4CAF50' }, // Kleur voor 'Behaald'
                            1: { color: '#FFC107' } // Kleur voor 'Nog te doen'
                        }
                    };
                    // Maak de grafiek en teken deze
                    var chart1 = new google.visualization.PieChart(document.getElementById('donutchart1'));
                    chart1.draw(formatieveData, options1);
                },
                error: function(jqXHR, textStatus, errorThrown) { // Bij fout
                    console.log("Error in formatieve toetsen AJAX call:", textStatus, errorThrown);
                }
            });

            // AJAX-aanroep voor summatieve toetsen
            $.ajax({
                url: 'summatief.php', // URL van de PHP-script die de data levert
                dataType: 'json', // Verwachte datatypes
                success: function(data) { // Bij succesvolle aanroep
                    console.log("Summatieve toetsen data:", data); // Log de ontvangen data

                    // Maak de data voor de piechart
                    var summatieveData = google.visualization.arrayToDataTable([
                        ['Task', 'Aantal'],
                        ['Behaald', parseFloat(data.behaald)], // Zorg ervoor dat dit een nummer is
                        ['Nog te doen', parseFloat(data.nog_te_doen)] // Zorg ervoor dat dit een nummer is
                    ]);

                    // Stijl en opties voor de grafiek
                    var options2 = {
                        title: 'Summatieve Toetsen',
                        pieHole: 0.4, // Maak een donut-grafiek
                        slices: {
                            0: { offset: 0.1, color: '#2196F3' }, // Kleur voor 'Behaald'
                            1: { color: '#FF5722' } // Kleur voor 'Nog te doen'
                        }
                    };
                    // Maak de grafiek en teken deze
                    var chart2 = new google.visualization.PieChart(document.getElementById('donutchart2'));
                    chart2.draw(summatieveData, options2);
                },
                error: function(jqXHR, textStatus, errorThrown) { // Bij fout
                    console.log("Error in summatieve toetsen AJAX call:", textStatus, errorThrown);
                }
            });

            // AJAX-aanroep voor de voortgangsgrafiek
            $.ajax({
                url: 'data.php', // URL van de PHP-script die de data levert
                dataType: 'json', // Verwachte datatypes
                success: function(data) { // Bij succesvolle aanroep
                    var voortgangData = new google.visualization.DataTable();
                    // Definieer de kolommen voor de DataTable
                    voortgangData.addColumn('string', 'Maand');
                    voortgangData.addColumn('number', 'Aantal behaalde toetsen en examens');

                    // Vul de DataTable met de ontvangen data
                    data.forEach(function(row) {
                        voortgangData.addRow([row.maand, parseInt(row.aantal)]); // Voeg elke maand en het aantal toe
                    });

                    // Stijl en opties voor de lijn grafiek
                    var options3 = {
                        title: 'Voortgang 2023-2024',
                        curveType: 'function', // Maak de lijn vloeiend
                        legend: { position: 'bottom' }, // Plaats de legenda onder de grafiek
                        hAxis: {
                            title: 'Maand', // Titel van de horizontale as
                        },
                        vAxis: {
                            title: 'Aantal toetsen en examens', // Titel van de verticale as
                            minValue: 0 // Minimumwaarde van de verticale as
                        },
                        width: 1820, // Breedte van de grafiek
                        height: 500 // Hoogte van de grafiek
                    };

                    // Maak de grafiek en teken deze
                    var chart3 = new google.charts.Line(document.getElementById('curve_chart'));
                    chart3.draw(voortgangData, google.charts.Line.convertOptions(options3));
                },
                error: function(jqXHR, textStatus, errorThrown) { // Bij fout
                    console.log("Error in voortgang AJAX call:", textStatus, errorThrown);
                }
            });
        }
    </script>
</head>
<body>
    <!-- Container voor de grafieken -->
    <div class="chart-container">
        <div id="donutchart1" class="chart"></div> <!-- Grafiek voor formatieve toetsen -->
        <div id="donutchart2" class="chart"></div> <!-- Grafiek voor summatieve toetsen -->
    </div>
    <div id="curve_chart" class="chart"></div> <!-- Grafiek voor voortgang -->
</body>
</html>
